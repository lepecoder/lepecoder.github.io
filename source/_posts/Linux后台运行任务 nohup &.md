---
title: Linux后台运行任务 nohup &
date: 2020-07-01T20:00:00
tags:
categories:
---

## Linux后台运行任务 nohup &


#### & 不中断

`&`表示在后台执行命令，没有办法通过`Ctrl+C`结束命令，但是可以通过关闭终端来杀掉进程。

![image-20200701192949473](https://img2020.cnblogs.com/blog/1205530/202007/1205530-20200701195835683-1516687088.png)


#### nohup 不挂起

`nohup`命令：如果你正在运行一个进程，而且你觉得在退出帐户时该进程还不会结束，那么可以使用`nohup`命令。该命令可以在你退出帐户/关闭终端之后继续运行相应的进程。`nohup`就是**不挂起**的意思( no hang up)

在我们关闭session时会发出SIGHUP信号，终端里运行的程序会结束，如果想要忽略SIGHUP信号，就需要在命令前增加nohup命令，此时关闭session后命令会继续执行。

![image-20200701162224060](https://img2020.cnblogs.com/blog/1205530/202007/1205530-20200701195835441-50411983.png)

此时会忽略输入，并将输出重定向到`nohup.out`，当然，你可以使用管道符自定义输出文件

![image-20200701162808273](https://img2020.cnblogs.com/blog/1205530/202007/1205530-20200701195835187-1194766780.png)

这样就将输出重定向到myout.file，redirecting stderr to stdout的意思是告诉你标准错误也会重定向到标准输出。当然，你也可以自己将标准错误重定向到输出，这样就不会有警告。

![image-20200701163015536](https://img2020.cnblogs.com/blog/1205530/202007/1205530-20200701195834965-1308556823.png)

对于2 ，表示标准错误，stderr。

对于&1 更准确的说应该是文件描述符 1,而1标识标准输出，stdout。


#### 结合nohup和&

很多时候单独的`nohup`并不能满足我们的需求，你会发现在执行上面的命令只能等待任务执行完，在此之前任何输入都没有用除非新开个终端，所以`nohup`经常和`&`一起用。

![image-20200701193158150](https://img2020.cnblogs.com/blog/1205530/202007/1205530-20200701195834681-1164445864.png)

此时程序在后台运行，你可以继续执行其他操作，而且关闭终端也不会影响任务的执行。

我们可以通过`jobs -l`来显示任务列表及状态，其中`-l`是显示进程号。但是jobs命令只对当前终端生效，当我们重新打开终端后jobs就不能显示任务状态了，此时只能用`ps`命令查看当前进程。

![image-20200701194949804](https://img2020.cnblogs.com/blog/1205530/202007/1205530-20200701195834311-92193861.png)

其中29979就是进程ID，15965是父进程ID，如果要结束某个进程，可以使用`kill`命令

```
kill -9 ID
```



#### 总结

`&`会在后台执行，忽略Ctrl+C的SIGINT信号

`nohup`会忽略关闭session的SIGHUP信号

一般同时使用nohup+&

    